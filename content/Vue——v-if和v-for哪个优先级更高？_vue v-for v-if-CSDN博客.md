首先我们需要知道关于这个问题，其实在[vue2](https://so.csdn.net/so/search?q=vue2\&spm=1001.2101.3001.7020)和 vue3 中的答案是截然相反的。

**实践中不应该把 v-for 和 v-if 放在一起**

先说结论：

* *在 vue2 中，v-for 的优先级高于 v-if*
* *在 vue3 中，v-if 的优先级高于 v-for*

通常有两种情况下导致我们这样做：

1\. 为了过滤列表中的项目，比如：

```
v-for="user in users" v-if="user.isActive"

1
```

* 在 vue2 中，把它们放在一起，输出的渲染函数中可以看出会先执行循环再判断条件，哪怕我们只渲染列表中一小部分元素，也得在每次重渲染的时候遍历整个列表，这会比较浪费
* 在 vue3 中，v-if 的优先级高于 v-fo，所以 v-if 执行时，它调用的变量还不存在，就会导致异常

此时定义一个[计算属性](https://so.csdn.net/so/search?q=%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7\&spm=1001.2101.3001.7020)（比如 `activeUsers`），让其返回过滤后的列表即可（比如`users.filter(u=>u.isActive)`）。

2\. 为了避免渲染本应该被隐藏的列表

```
v-for="user in users" v-if="shouldShowUsers"

1
```

* 同样，在 vue2 中，把它们放在一起，输出的渲染函数中可以看出会先执行循环再判断条件，哪怕我们只渲染列表中一小部分元素，也得在每次重渲染的时候遍历整个列表，这会比较浪费
* 在 vue3 中，这样写虽然并不会报错，但是官方还是及其不推荐外面这样去做

此时把`v-if`移动至容器元素上（比如`ul`、`ol`）或者外面包一层`template`即可。
