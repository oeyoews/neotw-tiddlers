浏览器从输入 URL 到页面渲染完成的过程可以分为以下几个关键步骤：

---

## **1. 解析 URL**
用户在浏览器地址栏输入 URL，浏览器会解析该 URL，识别出协议（如 `http://` 或 `https://`）、域名（如 `example.com`）、路径（如 `/index.html`）等信息。

---

## **2. DNS 解析**
浏览器需要将域名转换成 IP 地址，具体过程如下：
1. 浏览器缓存：检查本地是否缓存了该域名的 IP 地址（浏览器缓存）。
2. 操作系统缓存：如果浏览器没有缓存，会查询操作系统的 DNS 缓存。
3. 本地域名服务器（ISP 提供的 DNS 服务器）：如果本地没有缓存，会向本地 DNS 服务器查询。
4. 递归查询：
   - 若本地 DNS 服务器无结果，则向根域名服务器查询。
   - 根域名服务器返回顶级域名服务器（如 `.com` 的服务器）。
   - 顶级域名服务器返回权威 DNS 服务器（存储 `example.com` 的真实 IP）。
   - 权威 DNS 服务器返回 IP 地址，缓存并返回给浏览器。

---

## **3. 建立 TCP 连接**
拿到服务器 IP 地址后，浏览器通过 **TCP 三次握手** 与服务器建立连接：
1. **客户端** 发送 `SYN`（请求建立连接）。
2. **服务器** 返回 `SYN + ACK`（同意连接）。
3. **客户端** 发送 `ACK`（确认收到），连接建立。

**如果是 HTTPS，还需要进行 TLS/SSL 握手** 以建立加密连接。

---

## **4. 发送 HTTP 请求**
浏览器向服务器发送 HTTP 请求，包含：
- 请求方法（`GET`、`POST`、`PUT` 等）
- 请求头（`User-Agent`、`Accept`、`Cookie` 等）
- 请求体（POST 请求时带的数据）

---

## **5. 服务器处理请求并返回响应**
服务器接收到请求后，处理请求：
- 解析 URL，匹配路由
- 读取数据库，执行业务逻辑
- 生成 HTML / JSON 数据
- 通过 HTTP 响应返回数据（状态码、响应头、响应体）

如果是 **静态资源**（如 CSS、JS、图片），可能会从 CDN 返回。

---

## **6. 浏览器解析 & 渲染页面**
浏览器收到响应数据后，解析并渲染页面，过程如下：

### **6.1 解析 HTML**
浏览器 **自上而下** 解析 HTML，构建 **DOM 树**（Document Object Model）。

遇到 `<script>`：
- **普通 script**：解析到时会阻塞 DOM 解析，必须执行完后继续。
- **async**：异步下载脚本，下载完立即执行，不保证执行顺序。
- **defer**：异步下载脚本，等 HTML 解析完成后按顺序执行。

---

### **6.2 解析 CSS**
- 解析 CSS 文件，生成 **CSSOM（CSS Object Model）**。
- CSS 可能会阻塞渲染，直到 CSS 解析完成。

---

### **6.3 构建 Render Tree（渲染树）**
- **Render Tree = DOM + CSSOM**
- 只包含可见元素（`display: none` 的不会加入）。

---

### **6.4 计算布局（Layout / Reflow）**
计算每个元素的 **大小、位置**，确定最终的页面布局。

---

### **6.5 绘制（Paint）**
浏览器将各个元素绘制到屏幕上，涉及：
- 颜色填充
- 文本绘制
- 阴影、边框、渐变等

---

### **6.6 组合 & 显示（Compositing）**
浏览器可能会将页面拆成多个图层，合成后渲染到屏幕。

---

## **7. 浏览器优化**
为了提高性能，浏览器会进行：
- **预解析**：提前下载 CSS、JS、图片资源。
- **HTTP 缓存**：缓存静态资源，减少不必要的请求。
- **懒加载**：对于图片或 iframe 采用 `lazy-loading` 方式，延迟加载。

---

## **总结**
1. **解析 URL**
2. **DNS 解析**
3. **TCP 连接**
4. **发送 HTTP 请求**
5. **服务器返回数据**
6. **浏览器解析并渲染页面**
   - 解析 HTML，构建 DOM
   - 解析 CSS，构建 CSSOM
   - 生成渲染树
   - 计算布局
   - 绘制 & 显示

优化：
- **缓存**
- **懒加载**
- **异步加载 JS**
- **减少重排 & 重绘**

整个过程涉及 **网络、操作系统、浏览器渲染引擎、JavaScript 引擎等**，优化关键在于 **减少阻塞、减少网络请求、优化渲染**。

🚀 **想要页面更快？**
- 开启 **HTTP 缓存**
- 采用 **CDN 加速**
- 使用 **defer / async 加载 JS**
- 减少 **DOM 操作**
- 采用 **GPU 加速（transform、opacity）**