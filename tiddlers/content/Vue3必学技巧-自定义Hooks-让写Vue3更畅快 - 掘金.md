## Vue3 å¿…å­¦æŠ€å·§ - è‡ªå®šä¹‰ Hooks - è®©å†™ Vue3 æ›´ç•…å¿«

### å‰è¨€ï¼š

æ›´æ–°äº 2022-8-16ï¼šéšç€ Vue3 å®˜æ–¹æ•™ç¨‹çš„æ¨è¿›ï¼ŒVue3 è‡ªå®šä¹‰ hook å®˜æ–¹å·²ç»ç»™äº†å®šä¹‰ï¼Œå¹¶å†™äº†ç›¸åº”çš„æ•™ç¨‹ï¼ é£æœºâ¡ï¸â¡ï¸â¡ï¸â¡ï¸[ç»„åˆå¼å‡½æ•° | Vue.js (vuejs.org)](https://link.juejin.cn/?target=https%3A%2F%2Fcn.vuejs.org%2Fguide%2Freusability%2Fcomposables.html "https://cn.vuejs.org/guide/reusability/composables.html")

å®˜æ–¹å¯¹è‡ªå®šä¹‰ hook å®šä¹‰ï¼šåœ¨ Vue åº”ç”¨çš„æ¦‚å¿µä¸­ï¼Œâ€œç»„åˆå¼å‡½æ•°â€ (Composables) æ˜¯ä¸€ä¸ªåˆ©ç”¨ Vue ç»„åˆå¼ API æ¥å°è£…å’Œå¤ç”¨**æœ‰çŠ¶æ€é€»è¾‘**çš„å‡½æ•°ã€‚

> hook: ç›´è¯‘ \[hÊŠk] é’©å­
>
> Hooks åœ¨å‰ç«¯é¢†åŸŸå¹¶æ²¡æœ‰æ˜ç¡®å®šä¹‰ï¼Œå€Ÿç”¨çŸ¥ä¹å¤§ä½¬çš„å®šä¹‰ï¼šåœ¨ JS é‡Œæ˜¯ callback, äº‹ä»¶é©±åŠ¨ï¼Œé›†æˆå®šä¹‰ä¸€äº›**å¯å¤ç”¨çš„æ–¹æ³•**ã€‚

Vue3 å®˜æ–¹æ–‡æ¡£å¹¶æ²¡æœ‰å¯¹è‡ªå®šä¹‰ Hooks åšä»»ä½•å®šä¹‰ï¼Œå´æ— å¤„ä¸åœ¨åœ¨ä½¿ç”¨è¿™ä¸ªæŠ€å·§ï¼Œå¾ˆå¤šå¼€æºé¡¹ç›®ä¹Ÿåœ¨ç”¨è¿™ä¸ªæŠ€å·§ï¼Œæ‰€ä»¥ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„ Vuer å­¦ä¼šè‡ªå®šä¹‰ Hooks è®© Composition Api å†™èµ·æ¥æ›´ä¸°æ»¡æ˜¯ååˆ†å¿…è¦çš„ï¼ï¼ˆ[é£æœº - å®˜æ–¹æ–‡æ¡£åœ¨å·å·ä½¿ç”¨è‡ªå®šä¹‰ Hooks](https://link.juejin.cn/?target=https%3A%2F%2Fv3.cn.vuejs.org%2Fguide%2Fcomposition-api-introduction.html%23%25E7%258B%25AC%25E7%25AB%258B%25E7%259A%2584-computed-%25E5%25B1%259E%25E6%2580%25A7 "https://v3.cn.vuejs.org/guide/composition-api-introduction.html#%E7%8B%AC%E7%AB%8B%E7%9A%84-computed-%E5%B1%9E%E6%80%A7")ï¼‰

### Vue3 è‡ªå®šä¹‰ Hooks å®šä¹‰ï¼š

> ä¸ªäººç†è§£ï¼šä¸€äº›**å¯å¤ç”¨çš„æ–¹æ³•**åƒé’©å­ä¸€æ ·æŒ‚ç€ï¼Œå¯ä»¥éšæ—¶è¢«å¼•å…¥å’Œè°ƒç”¨ä»¥å®ç°**é«˜å†…èšä½è€¦åˆ**çš„ç›®æ ‡ï¼Œåº”è¯¥éƒ½èƒ½ç®—æ˜¯ hookï¼›

### ä¸ºä»€ä¹ˆ Vue3 è¦ç”¨è‡ªå®šä¹‰ Hookï¼Ÿï¼š

ç»“è®ºï¼šå°±æ˜¯ä¸ºäº†è®©`Compoosition Api`æ›´å¥½ç”¨æ›´ä¸°æ»¡ï¼Œè®©å†™ Vue3 æ›´ç•…å¿«ï¼åƒå†™è¯—ä¸€æ ·å†™ä»£ç ï¼ å…¶å®è¿™ä¸ªé—®é¢˜æ›´æ·±æ„ä¹‰æ˜¯ä¸ºä»€ä¹ˆ Vue3 æ¯” Vue2 æ›´å¥½ï¼æ— å¤–å‘¼**æ€§èƒ½å¤§å¹…åº¦æå‡**ï¼Œå…¶å®ç¼–ç ä½“éªŒä¹Ÿæ˜¯ Vue3 çš„ä¼˜ç‚¹ \*\*`Composition Api`çš„å¼•å…¥ï¼ˆè§£å†³ Option Api åœ¨ä»£ç é‡å¤§çš„æƒ…å†µä¸‹çš„å¼ºè€¦åˆï¼‰\*\* è®©å¼€å‘è€…æœ‰æ›´å¥½çš„å¼€å‘ä½“éªŒã€‚

ä¸ªäººç¢ç¢å¿µï¼šä½†æ˜¯è¿™äº›æ‰€è°“çš„æé«˜å¼€å‘ä½“éªŒéƒ½æ˜¯éœ€è¦å¼€å‘è€…ä¸æ–­å­¦ä¹ å…»æˆç¼–ç å¥½ä¹ æƒ¯ï¼ŒåŒæ ·æ˜¯ Vue3 å†™ Compoosition Api æœ‰çš„äººå°±èƒ½å†™å¾—å’Œè¯—ä¸€æ ·ï¼Œæœ‰çš„äººå´èƒ½å†™å¾—åƒğŸ’©ä¸€æ ·ï¼ˆè¡·å¿ƒå¸Œæœ›æ¯ä¸ªå¼€å‘è€…éƒ½æœ‰ä¸€é¢—å¯¹æŠ€æœ¯çƒ­è¡·çš„å¿ƒï¼Œä¸è¦ä¸ºäº†å¼€å‘è€Œå¼€å‘ï¼Œå‰äººå†™ç¿”è®©åäººå°ï¼æŠ±æ­‰æœ€è¿‘å› ä¸ºç»´æŠ¤è€é¡¹ç›®å¤ªå¤šæ„Ÿæ…¨ï¼‰

#### å†™ Vue3 è¯·æ‘†è„± Vue2 æ— è„‘ this çš„æ€æƒ³ï¼š

> å†™ Vue2 ä¸­å¾ˆå¤šåŒå­¦å…»æˆäº† `Option Api`æ— è„‘ this çš„ä¹ æƒ¯ï¼Œæ¥åˆ°`Vue3`çš„`Composition Api`è¿˜æ˜¯ä¹ æƒ¯æ€§æƒ³ç”¨ thisï¼Œæ›´æœ‰äººä¸ºäº†å†™ this ä¸æƒœå¼•å…¥`getCurrentInstance`! è¿™å¤§å¯ä¸å¿…ï¼

`Composition Api`çš„ä¼˜ç‚¹ä¹‹ä¸€å°±æ˜¯**æ‘†è„±æ— è„‘ this å¯¼è‡´çš„å¼ºè€¦åˆ**ï¼ŒåŠŸèƒ½ä¹‹é—´äº’ç›¸ thisï¼Œå˜é‡å’Œæ–¹æ³•åœ¨å„ä¸ªæ–¹æ³•æ··æ‚ï¼Œæ— å¤„ä¸åœ¨çš„ this æ˜¯å¼ºè€¦åˆçš„ï¼Œè™½ç„¶æ–¹ä¾¿ï¼Œä½†æ˜¯ç¢ç‰‡åŒ–çš„ option api åæœŸç»´æŠ¤æ˜¯éº»çƒ¦çš„ã€‚

æˆ‘ç›¸ä¿¡å†™`Vue2`çš„åŒå­¦ï¼Œä¸€å®šæ·±æœ‰æ„Ÿè§¦ï¼Œä¸€ä¸ªç»„ä»¶ä¸‹å®šä¹‰å¤§é‡å˜å’Œå¤§é‡æ–¹æ³•ï¼Œ**æ–¹æ³•åµŒå¥—æ–¹æ³•ï¼Œæ–¹æ³•ä¹‹é—´äº’ç›¸å…±äº«å˜é‡**ï¼Œç»´æŠ¤è¿™æ ·çš„ä»£ç ï¼Œçœ‹ä¼¼å®¹æ˜“ç†è§£çš„`Option Api`å†™æ³•ï¼Œæˆ‘ä»¬éœ€è¦åœ¨`methosã€dataã€template`ä¹‹é—´æ¥å›åˆ‡ï¼Œ`Option Api`è¿™ç§å†™æ³•ï¼Œä»£ç é‡å’ŒåŠŸèƒ½å°å·§æ—¶æ˜¯ååˆ†ç®€å•æ˜äº†çš„ï¼Œä½†æ˜¯ä»£ç é‡ä¸€å¤šï¼ŒåŠŸèƒ½ä¸€å¤æ‚ï¼Œæˆ‘ç›¸ä¿¡ review ä»£ç çš„æ—¶å€™å¤´éƒ½ç—›ã€‚

ç›¸å¯¹çš„`Composition Api`åœ¨åŠŸèƒ½å¤æ‚ã€ä»£ç é‡å·¨å¤§çš„ç»„ä»¶ä¸‹ï¼Œæˆ‘ä»¬é…åˆ**è‡ªå®šä¹‰ Hooks**ï¼Œå°†ä»£ç é€šè¿‡**åŠŸèƒ½åˆ†å—å†™**ï¼Œ**å“åº”å˜é‡å’Œæ–¹æ³•åœ¨ä¸€èµ·å®šä¹‰å’Œè°ƒç”¨**ï¼Œè¿™ï¿½ï¿½ï¿½åæœŸæˆ‘ä»¬æ”¹åŠŸèƒ½ A åªéœ€è¦å…³æ³¨åŠŸèƒ½ A å—ä¸‹çš„ä»£ç ï¼Œä¸ä¼šåƒ Vue2 åœ¨`Option Api`éœ€è¦åŒæ—¶å…³æ³¨ methos å’Œ dataã€‚ã€‚ã€‚ã€‚ã€‚

#### å‡ å¼ åŠ¨å›¾å†æ¥å¤ä¹ ä¸€é **`Composition Api` å¥½ï¼**

> è°¢è°¢ [`å¤§å¸…è€çŒ¿`](https://juejin.cn/post/6890545920883032071 "https://juejin.cn/post/6890545920883032071") è€å¸ˆåšçš„åŠ¨å›¾ï¼Œ`Composition Api VS Option Api` çš„ä¼˜ç¼ºç‚¹ååˆ†æ˜äº†å±•ç¤ºåœ¨äº†åŠ¨ç”»ä¸Šï¼

##### `Option Api`ä»£ç é‡å°‘è¿˜å¥½ï¼Œä»£ç é‡å¤šå®¹æ˜“å¯¼è‡´é«˜è€¦åˆï¼

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/085b2a6c8c2d478998ea8e6e3c9318f8~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68ba1970275b4acf9213df5540614ea1~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

è¯´æ˜ï¼šä¸Šé¢æ˜¯`Vue2 Option Api`çš„å†™æ³•ï¼Œä¸€ä¸ªç»„ä»¶ä¸‹å«æœ‰`data ã€methosã€computedã€watch`ï¼ŒåŒä¸€ä¸ªåŠŸèƒ½éœ€è¦åˆ†å¼€å†™åœ¨è¿™äº›å‡½æ•°ä¸Šï¼Œå¦‚æœä»£ç é‡å°‘ï¼Œé‚£çœ‹èµ·æ¥ä¼¼ä¹ååˆ†æ˜äº†æ¸…æ™°ã€‚ä¸€æ—¦ä»£ç é‡å¤§åŠŸèƒ½å¤æ‚ï¼Œå„ä¸ªåŠŸèƒ½åˆ†å¼€å†™ï¼Œç»´æŠ¤çš„æ—¶å€™`data ã€methosã€computedã€watch`éƒ½éœ€è¦æ¥å›åˆ‡ï¼Œåè€Œæ˜¾å¾—**è¿‡äºåˆ†æ•£ï¼Œåˆé«˜åº¦è€¦åˆ**ã€‚

##### `Composition Api`è§£è€¦`Vue2 Option Api`å®ç°ä½è€¦åˆé«˜å†…èš

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a83506358e66431aa7bc94e7c2c71144~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

è¯´æ˜ï¼šå¦‚æœæ˜¯`Composition Api`åœ¨åŠŸèƒ½å¤æ‚ã€ä»£ç é‡å·¨å¤§çš„ç»„ä»¶ä¸‹ï¼Œæˆ‘ä»¬é…åˆ**è‡ªå®šä¹‰ Hook**ï¼Œå°†ä»£ç **æŒ‰åŠŸèƒ½åˆ†å—å†™ï¼Œå˜é‡å’Œæ–¹æ³•åœ¨ä¸€èµ·å®šä¹‰å’Œè°ƒç”¨**ï¼Œæ¯”å¦‚ A åŠŸèƒ½ä¸‹é›†æˆäº†å“åº”å¼å˜é‡å’Œæ–¹æ³•ï¼Œæˆ‘ä»¬åæœŸç»´æŠ¤åªéœ€è¦æ”¹åŠ¨ A åŠŸèƒ½æ¨¡å—ä¸‹çš„ä»£ç ï¼Œä¸ä¼šåƒ Vue2 åœ¨`Option Api`éœ€è¦åŒæ—¶å…³æ³¨é€»è¾‘åˆ†æ•£çš„ methos å’Œ dataã€‚

æ‰€ä»¥**è‡ªå®šä¹‰ Hook çš„å†™ Vue3 å¿…é¡»æŒæ¡çš„ï¼å®ƒæ— ä¸ä½“ç° Vue3 Composition Api ä½è€¦åˆé«˜å†…èšçš„æ€æƒ³ï¼** ç¬”è€…åœ¨çœ‹äº†å®˜æ–¹æ–‡æ¡£å’Œå¼€æºçš„ admin æ¨¡æ¿éƒ½æ˜¯å¤§é‡ä½¿ç”¨è‡ªå®šä¹‰ Hooks çš„ï¼

### å¤§èƒ†å®šä¹‰ä¸€ä¸‹ Vue3 çš„è‡ªå®šä¹‰ Hookï¼š

> è™½ç„¶å®˜æ–¹æ²¡æœ‰æ˜ç¡®æŒ‡æ˜æˆ–å®šä¹‰ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰ Hooksï¼Œä½†æ˜¯å´æ— å¤„ä¸åœ¨ç”¨ï¼›
>
> ä»¥å‡½æ•°å½¢å¼æŠ½ç¦»ä¸€äº›**å¯å¤ç”¨çš„æ–¹æ³•**åƒé’©å­ä¸€æ ·æŒ‚ç€ï¼Œéšæ—¶å¯ä»¥å¼•å…¥å’Œè°ƒç”¨ï¼Œå®ç°**é«˜å†…èšä½è€¦åˆ**çš„ç›®æ ‡ï¼›

1. å°†å¯å¤ç”¨åŠŸèƒ½æŠ½ç¦»ä¸ºå¤–éƒ¨ JS æ–‡ä»¶

2. å‡½æ•°å / æ–‡ä»¶åä»¥ use å¼€å¤´ï¼Œå½¢å¦‚ï¼šuseXX

3. å¼•ç”¨æ—¶å°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•æ˜¾å¼è§£æ„æš´éœ²å‡ºæ¥å¦‚ï¼š`const {nameRefï¼ŒFn} = useXX()`

   ï¼ˆåœ¨ setup å‡½æ•°è§£æ„å‡ºè‡ªå®šä¹‰ hooks çš„å˜é‡å’Œæ–¹æ³•ï¼‰

### å®ä¾‹ï¼š

> ç®€å•çš„åŠ å‡æ³•è®¡ç®—ï¼Œå°†åŠ æ³•å’Œå‡æ³•æŠ½ç¦»ä¸º 2 ä¸ªè‡ªå®šä¹‰ Hooksï¼Œå¹¶ä¸”ç›¸äº’ä¼ é€’å“åº”å¼æ•°æ®

* åŠ æ³•åŠŸèƒ½ - Hook

```
import { ref, watch } from 'vue';
const useAdd= ({ num1, num2 }) Â =>{
 Â  Â const addNum = ref(0)
 Â  Â watch([num1, num2], ([num1, num2]) => {
 Â  Â  Â  Â addFn(num1, num2)
 Â   })
 Â  Â const addFn = (num1, num2) => {
 Â  Â  Â  Â addNum.value = num1 + num2
 Â   }
 Â  Â return {
 Â  Â  Â  Â addNum,
 Â  Â  Â  Â addFn
 Â   }
}
export default useAdd
```

* å‡æ³•åŠŸèƒ½ - Hook

```
//å‡æ³•åŠŸèƒ½-Hook
import { ref, watch } from 'vue';
export function useSub  ({ num1, num2 }){
 Â  Â const subNum = ref(0)
 Â  Â watch([num1, num2], ([num1, num2]) => {
 Â  Â  Â  Â subFn(num1, num2)
 Â   })
 Â  Â const subFn = (num1, num2) => {
 Â  Â  Â  Â subNum.value = num1 - num2
 Â   }
 Â  Â return {
 Â  Â  Â  Â subNum,
 Â  Â  Â  Â subFn
 Â   }
}
```

* åŠ å‡æ³•è®¡ç®—ç»„ä»¶

```
<template>
 Â  Â <div>
 Â  Â  Â   num1:<input v-model.number="num1" style="width:100px" />
 Â  Â  Â  Â <br />
 Â  Â  Â   num2:<input v-model.number="num2" style="width:100px" />
 Â  Â </div>
 Â  Â <span>åŠ æ³•ç­‰äº:{{ addNum }}</span>
 Â  Â <br />
 Â  Â <span>å‡æ³•ç­‰äº:{{ subNum }}</span>
</template>
â€‹
<script setup>
import { ref } from 'vue'
import useAdd from './useAdd.js' Â  Â  //å¼•å…¥è‡ªåŠ¨hook 
import { useSub } from './useSub.js' //å¼•å…¥è‡ªåŠ¨hook 
â€‹
const num1 = ref(2)
const num2 = ref(1)
//åŠ æ³•åŠŸèƒ½-è‡ªå®šä¹‰Hookï¼ˆå°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•å½¢å¼æš´éœ²å‡ºæ¥ï¼‰
const { addNum, addFn } = useAdd({ num1, num2 })
addFn(num1.value, num2.value)
//å‡æ³•åŠŸèƒ½-è‡ªå®šä¹‰Hook (å°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•å½¢å¼æš´éœ²å‡ºæ¥)
const { subNum, subFn } = useSub({ num1, num2 })
subFn(num1.value, num2.value)
</script>
â€‹
```

### é€šè¿‡ä¸Šè¿°ç¤ºä¾‹å†æ¥è¯´è¯´ Vue3 è‡ªå®šä¹‰ Hooks å’Œ Vue2 æ—¶ä»£ Mixin çš„å…³ç³»ï¼š

```
Mixinä¸è¶³
åœ¨ Vue 2 ä¸­ï¼Œmixin æ˜¯å°†éƒ¨åˆ†ç»„ä»¶é€»è¾‘æŠ½è±¡æˆå¯é‡ç”¨å—çš„ä¸»è¦å·¥å…·ã€‚ä½†æ˜¯ï¼Œä»–ä»¬æœ‰å‡ ä¸ªé—®é¢˜ï¼š
1ã€Mixin å¾ˆå®¹æ˜“å‘ç”Ÿå†²çªï¼šå› ä¸ºæ¯ä¸ª mixin çš„ property éƒ½è¢«åˆå¹¶åˆ°åŒä¸€ä¸ªç»„ä»¶ä¸­ï¼Œæ‰€ä»¥ä¸ºäº†é¿å… property åå†²çªï¼Œä½ ä»ç„¶éœ€è¦äº†è§£å…¶ä»–æ¯ä¸ªç‰¹æ€§ã€‚
2ã€å¯é‡ç”¨æ€§æ˜¯æœ‰é™çš„ï¼šæˆ‘ä»¬ä¸èƒ½å‘ mixin ä¼ é€’ä»»ä½•å‚æ•°æ¥æ”¹å˜å®ƒçš„é€»è¾‘ï¼Œè¿™é™ä½äº†å®ƒä»¬åœ¨æŠ½è±¡é€»è¾‘æ–¹é¢çš„çµæ´»æ€§ã€‚
```

ä¸Šé¢è¿™æ®µæ˜¯ Vue3 å®˜æ–¹æ–‡æ¡£çš„å†…å®¹ï¼Œå¯ä»¥æ¦‚æ‹¬å’Œè¡¥å……ä¸ºï¼š

#### 1ã€Mixin éš¾ä»¥è¿½æº¯çš„æ–¹æ³•ä¸å±æ€§ï¼Vue3 è‡ªå®šä¹‰ Hooks å´å¯ä»¥

> Vue3 è‡ªå®šä¹‰ Hooks, å¼•ç”¨æ—¶å°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•æ˜¾å¼æš´éœ²å‡ºæ¥å¦‚ï¼š
>
> `const {nameRefï¼ŒFn} = useXX()`

* Mixins

  ```
  export default {
   Â mixins: [ a, b, c, d, e, f, g ], //ä¸€ä¸ªç»„ä»¶å†…å¯ä»¥æ··å…¥å„ç§åŠŸèƒ½çš„Mixin
   Â mounted() {
   Â  Â console.log(this.name) Â //é—®é¢˜æ¥äº†ï¼Œè¿™ä¸ªnameæ˜¯æ¥è‡ªäºå“ªä¸ªmixinï¼Ÿ
    }
  }
  ```

  Mixin ä¸æ˜çš„æ··æ·†ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•è·çŸ¥å±æ€§æ¥è‡ªäºå“ªä¸ª Mixin æ–‡ä»¶ï¼Œç»™åæœŸç»´æŠ¤å¸¦æ¥å›°éš¾

* Vue3 è‡ªå®šä¹‰ Hooks

  ```
  //åŠ æ³•åŠŸèƒ½-è‡ªå®šä¹‰Hookï¼ˆå°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•å½¢å¼æš´éœ²å‡ºæ¥ï¼‰
  const { addNum, addFn } = useAdd({ num1, num2 })
  addFn(num1.value, num2.value)
  //å‡æ³•åŠŸèƒ½-è‡ªå®šä¹‰Hook (å°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•å½¢å¼æš´éœ²å‡ºæ¥)
  const { subNum, subFn } = useSub({ num1, num2 })
  subFn(num1.value, num2.value)
  ```

  æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºæ¯ä¸ª Hooks æ˜¾å¼æš´éœ²å‡ºæ¥çš„å“åº”å¼å˜é‡å’Œæ–¹æ³•

#### 2ã€æ— æ³•å‘ Mixin ä¼ é€’å‚æ•°æ¥æ”¹å˜é€»è¾‘ï¼Œä½†æ˜¯ Vue3 è‡ªå®šä¹‰ Hooks å´å¯ä»¥ï¼š

> Vue3 è‡ªå®šä¹‰ Hooks å¯ä»¥çµæ´»ä¼ é€’ä»»ä½•å‚æ•°æ¥æ”¹å˜å®ƒçš„é€»è¾‘ï¼Œå‚æ•°ä¸é™äºå…¶ä»– hook çš„æš´éœ²å‡ºæ¥çš„å˜é‡

* Mixins

```
export default {
 Â mixins: [ addMixin, subMixin], //ç»„ä»¶å†…æ··å…¥åŠ æ³•å’Œå‡æ³•Mixin
 Â mounted(){
 Â  Â  Â this.add(num1,num2) //è°ƒç”¨addMixinå†…éƒ¨çš„addæ–¹æ³•
 Â  Â  Â this.sub(num1,num2) //è°ƒç”¨subMixinå†…éƒ¨çš„subæ–¹æ³•
  } Â 
}
```

å¯ä»¥é€šè¿‡è°ƒç”¨ Mixin å†…éƒ¨æ–¹æ³•æ¥ä¼ é€’å‚æ•°ï¼Œå´æ— æ³•ç›´æ¥ç»™ Mixin ä¼ é€’å‚æ•°ï¼Œå› ä¸º Mixin ä¸æ˜¯å‡½æ•°å½¢å¼æš´éœ²çš„ï¼Œä¸å‘ä¼ å‚

* Vue3 è‡ªå®šä¹‰ Hook

  > åœ¨ä¸Šé¢å®ä¾‹åŸºç¡€ä¸Šæ·»åŠ ä¸ªç®—å¹³å‡çš„ Hook

  ```
  //å¹³å‡åŠŸèƒ½-Hook
  import { ref, watch } from "vue";
  export function useAverage(addNum) {
   Â const averageNum = ref(0);
   Â watch(addNum, (addNum) => {
   Â  Â averageFn(addNum);
    });
   Â const averageFn = (addNum) => {
   Â  Â averageNum.value = addNum / 2;
    };
   Â return {
   Â  Â averageNum,
   Â  Â averageFn,
    };
  }
  ```

  ç»„ä»¶å†…

  ```
  //ç»„ä»¶å†…
  //åŠ æ³•åŠŸèƒ½-è‡ªå®šä¹‰Hookï¼ˆå°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•å½¢å¼æš´éœ²å‡ºæ¥ï¼‰
  const { addNum, addFn } = useAdd({ num1, num2 })
  addFn(num1.value, num2.value)//ä¸»åŠ¨è°ƒç”¨ï¼Œè¿”å›æœ€æ–°addNum
  //å¹³å‡åŠŸèƒ½-è‡ªå®šä¹‰Hook- hookä¼ å…¥å‚æ•°å€¼æ¥å…¶ä»–hookæš´éœ²å‡ºæ¥çš„å˜é‡
  const { averageNum, averageFn} = useAverage(addNum)
  averageFn(addNum.value)
  ```

  Vue3 è‡ªå®šä¹‰ Hooks å¯ä»¥çµæ´»ä¼ é€’ä»»ä½•å‚æ•°æ¥æ”¹å˜å®ƒçš„é€»è¾‘ï¼Œå‚æ•°ä¸é™äºå…¶ä»– hook çš„æš´éœ²å‡ºæ¥çš„å˜é‡ï¼Œè¿™æé«˜äº† Vue3 åœ¨æŠ½è±¡é€»è¾‘æ–¹é¢çš„çµæ´»æ€§ã€‚

#### 3ã€Mixin åŒåå˜é‡ä¼šè¢«è¦†ç›–ï¼ŒVue3 è‡ªå®šä¹‰ Hook å¯ä»¥åœ¨å¼•å…¥çš„æ—¶å€™å¯¹åŒåå˜é‡é‡å‘½å

* Mixins

  ```
  export default {
   Â mixins: [ addMixin, subMixin], //ç»„ä»¶å†…æ··å…¥åŠ æ³•å’Œå‡æ³•Mixin
   Â mounted(){
   Â  Â  Â this.add(num1,num2) //è°ƒç”¨åŠ æ³•addMixinå†…éƒ¨çš„addæ–¹æ³•
   Â  Â  Â this.sub(num1,num2) //è°ƒç”¨å‡æ³•subMixinå†…éƒ¨çš„subæ–¹æ³•
    } Â 
  }
  ```

  å¦‚æœ`this.add(num1,num2)`å’Œ `this.sub(num1,num2)` è®¡ç®—çš„ç»“æœè¿”å›çš„åŒåå˜é‡ totalNumï¼Œç”±äº JS å•çº¿ç¨‹ï¼Œåé¢å¼•å…¥çš„ä¼šè¦†ç›–å‰é¢çš„ï¼ŒtotalNum æœ€ç»ˆæ˜¯å‡æ³• sub çš„å€¼

* Vue3 è‡ªå®šä¹‰ Hooks

  ```
  //åŠ æ³•åŠŸèƒ½-è‡ªå®šä¹‰Hookï¼ˆå°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•å½¢å¼æš´éœ²å‡ºæ¥ï¼‰
  const { totalNum:addNum, addFn } = useAdd({ num1, num2 })
  addFn(num1.value, num2.value)
  //å‡æ³•åŠŸèƒ½-è‡ªå®šä¹‰Hook (å°†å“åº”å¼å˜é‡æˆ–è€…æ–¹æ³•å½¢å¼æš´éœ²å‡ºæ¥)
  const { totalNum:subNum, subFn } = useSub({ num1, num2 })
  subFn(num1.value, num2.value)
  ```

  åœ¨ Vue3 è‡ªå®šä¹‰ Hooks ä¸­ï¼Œè™½ç„¶åŠ æ³•å’Œå‡æ³• Hooks éƒ½è¿”å›äº† totalNumï¼Œä½†æ˜¯åˆ©ç”¨ ES6 å¯¹è±¡è§£æ„å¾ˆè½»æ¾ç»™å˜é‡é‡å‘½å

### æ€»ç»“ï¼š

Vue2 æ—¶ä»£`Option Api ï¼Œdataã€methosã€watch.....`åˆ†å¼€å†™ï¼Œè¿™ç§æ˜¯**ç¢ç‰‡åŒ–**çš„åˆ†æ•£çš„ï¼Œä»£ç ä¸€å¤šå°±å®¹æ˜“**é«˜è€¦åˆ**ï¼Œç»´æŠ¤æ—¶æ¥å›åˆ‡æ¢ä»£ç æ˜¯ç¹ççš„ï¼

Vue3 æ—¶ä»£`Composition Api`ï¼Œé€šè¿‡åˆ©ç”¨å„ç§ Hooks å’Œè‡ªå®šä¹‰ Hooks å°†ç¢ç‰‡åŒ–çš„å“åº”å¼å˜é‡å’Œæ–¹æ³•**æŒ‰åŠŸèƒ½åˆ†å—å†™**ï¼Œå®ç°**é«˜å†…èšä½è€¦åˆ**

å½¢è±¡çš„è®²æ³•ï¼šVue3 è‡ªå®šä¹‰ Hooks æ˜¯ç»„ä»¶ä¸‹çš„å‡½æ•°ä½œç”¨åŸŸçš„ï¼Œè€Œ Vue2 æ—¶ä»£çš„ Mixins æ˜¯ç»„ä»¶ä¸‹çš„å…¨å±€ä½œç”¨åŸŸã€‚å…¨å±€ä½œç”¨åŸŸæœ‰æ—¶å€™æ˜¯ä¸å¯æ§çš„ï¼Œå°±åƒ var å’Œ let è¿™äº›å˜é‡å£°æ˜å…³é”®å­—ä¸€æ ·ï¼Œconst å’Œ let æ˜¯ var çš„ä¿®æ­£ã€‚Composition Api æ­£æ˜¯å¯¹ Vue2 æ—¶ä»£ Option Api é«˜è€¦åˆå’Œéšå¤„å¯è§ this çš„é»‘ç›’çš„ä¿®æ­£ï¼ŒVue3 è‡ªå®šä¹‰ Hooks æ˜¯ä¸€ç§è¿›æ­¥ã€‚

æŠŠ Mixin å’Œè‡ªå®šä¹‰ Hook è¿›è¡Œæ¯”è¾ƒï¼Œä¸€ä¸ªæ˜¯ Option Api çš„ä½“ç°ï¼Œä¸€ä¸ªæ˜¯ Composition Api çš„ä½“ç°ã€‚å¦‚æœèƒ½ç†è§£**é«˜å†…èšä½è€¦åˆ**çš„æ€æƒ³ï¼Œé‚£ä¹ˆå°±èƒ½ç†è§£ä¸ºä»€ä¹ˆ Vue3 æ˜¯ä½¿ç”¨ Composition Apiï¼Œå¹¶é€šè¿‡å„ç§è‡ªå®šä¹‰ Hooks ä½¿ä»£ç æ›´å¼ºå£®ã€‚åƒå†™è¯—ä¸€æ ·å†™ä»£ç ã€‚è€Œä¸æ˜¯å†™å±ã€‚

æœ€åå†æ¬¡æ„Ÿè°¢ [`å¤§å¸…è€çŒ¿`](https://juejin.cn/post/6890545920883032071 "https://juejin.cn/post/6890545920883032071") è€å¸ˆåšçš„åŠ¨å›¾ï¼

å¦‚æœè§‰å¾—è®²å¾—è¿˜è¡Œï¼Œä¸åå•¬ç‚¹ä¸ªèµå†èµ°ï¼
